!function(){"use strict";class t extends Phaser.Scene{preload(){this.load.on("progress",this.progress,this),this.load.image("background","assets/background.png"),this.load.spritesheet("player","assets/player2.png",{frameWidth:20,frameHeight:20}),this.load.image("coin","assets/coin.png"),this.load.image("enemy","assets/enemy.png"),this.load.image("pixel","assets/pixel.png"),this.load.image("tileset","assets/tileset.png"),this.load.image("jumpButton","assets/jumpButton.png"),this.load.image("rightButton","assets/rightButton.png"),this.load.image("leftButton","assets/leftButton.png"),this.load.spritesheet("muteButton","assets/muteButton.png",{frameWidth:28,frameHeight:22}),this.load.tilemapTiledJSON("map","assets/map.json"),this.loadLabel=this.add.text(250,170,"loading\n0%",{font:"30px Geo",color:"#fff",align:"center"}),this.loadLabel.setOrigin(.5,.5),this.load.audio("jump",["assets/jump.ogg","assets/jump.mp3"]),this.load.audio("coin",["assets/coin.ogg","assets/coin.mp3"]),this.load.audio("dead",["assets/dead.ogg","assets/dead.mp3"])}create(){this.scene.start("menu")}progress(t){let e=Math.round(100*t)+"%";this.loadLabel.setText("loading\n"+e)}}class e extends Phaser.Scene{create(t){let e=t.score?t.score:0;null===localStorage.getItem("bestScore")&&localStorage.setItem("bestScore","0"),e>localStorage.getItem("bestScore")&&localStorage.setItem("bestScore",e),this.add.image(250,170,"background");let s=this.add.text(250,-50,"Super Coin Box",{font:"50px Geo",color:"#fff"});s.setOrigin(.5,.5),this.tweens.add({targets:s,y:80,duration:1e3,ease:"bounce.out"});let i,a="score: "+e+"\nbest score: "+localStorage.getItem("bestScore");this.add.text(250,170,a,{font:"25px Geo",color:"#fff",align:"center"}).setOrigin(.5,.5),i=this.sys.game.device.os.desktop?"press the up arrow key to start":"touch the screen to start";let o=this.add.text(250,260,i,{font:"25px Geo",color:"#fff"});o.setOrigin(.5,.5),this.tweens.add({targets:o,angle:{from:-2,to:2},duration:1e3,yoyo:!0,repeate:-1}),this.upKey=this.input.keyboard.addKey("up"),this.addMuteButton()}update(){!this.sys.game.device.os.desktop&&this.input.activePointer.y<60||((this.upKey.isDown||!this.sys.game.device.os.desktop&&this.input.activePointer.isDown)&&this.scene.start("play"),this.game.sound.mute?this.soundButton.setFrame(1):this.soundButton.setFrame(0))}addMuteButton(){this.soundButton=this.add.sprite(34,26,"muteButton"),this.soundButton.setInteractive(),this.soundButton.on("pointerdown",this.toggleMute,this)}toggleMute(){this.game.sound.mute?(this.game.sound.mute=!1,this.soundButton.setFrame(0)):(this.game.sound.mute=!0,this.soundButton.setFrame(1))}}class s extends Phaser.Scene{create(){this.jumpSound=this.sound.add("jump"),this.coinSound=this.sound.add("coin"),this.deadSound=this.sound.add("dead"),this.player=this.physics.add.sprite(250,170,"player"),this.player.body.gravity.y=500,this.anims.create({key:"right",frames:this.anims.generateFrameNumbers("player",{frames:[1,2]}),frameRate:8,repeat:-1}),this.anims.create({key:"left",frames:this.anims.generateFrameNumbers("player",{frames:[3,4]}),frameRate:8,repeat:-1}),this.arrow=this.input.keyboard.createCursorKeys(),this.createWorld(),this.coin=this.physics.add.sprite(60,130,"coin"),this.scoreLabel=this.add.text(30,25,"score: 0",{font:"18px Geo",color:"#fff"}),this.score=0,this.enemies=this.physics.add.group(),this.nextEnemy=Date.now()+2200,this.sys.game.device.os.desktop||(this.input.addPointer(1),this.addMobileInputs(),this.rotateLabel=this.add.text(250,170,"",{font:"30px Geo",color:"#fff",backgroundColor:"#000"}),this.rotateLabel.setOrigin(.5,.5),this.scale.on("orientationchange",this.orientationChange,this),this.orientationChange()),this.emitter=this.add.particles(this.player.x,this.player.y,"pixel",{quantity:15,speed:{min:-150,max:150},scale:{start:2,end:.1},lifespan:800,emitting:!1})}update(){if(this.physics.collide(this.player,this.walls),this.physics.collide(this.enemies,this.walls),!this.player.active)return;this.movePlayer();let t=Date.now();if(this.nextEnemy<t){let e=4e3,s=100,i=e-(e-1e3)*Math.min(this.score/s,1);this.addEnemy(),this.nextEnemy=t+i}this.physics.overlap(this.player,this.coin)&&this.takeCoin(),(this.player.y>340||this.player.y<0)&&this.playerDie(),this.physics.overlap(this.player,this.enemies)&&this.playerDie()}createWorld(){let t=this.add.tilemap("map"),e=t.addTilesetImage("tileset","tileset");this.walls=t.createLayer("Tile Layer 1",e),this.walls.setCollision(1)}movePlayer(){this.arrow.left.isDown||this.moveLeft?(this.player.body.velocity.x=-200,this.player.anims.play("left",!0)):this.arrow.right.isDown||this.moveRight?(this.player.body.velocity.x=200,this.player.anims.play("right",!0)):(this.player.body.velocity.x=0,this.player.setFrame(0)),this.arrow.up.isDown&&this.jumpPlayer()}takeCoin(){this.score+=5,this.scoreLabel.setText("score: "+this.score),this.coinSound.play(),this.coin.setScale(0),this.tweens.add({targets:this.coin,scale:1,duration:300}),this.tweens.add({targets:this.player,scale:1.3,duration:100,yoyo:!0}),this.updateCoinPosition()}updateCoinPosition(){let t=[{x:140,y:60},{x:360,y:60},{x:60,y:140},{x:440,y:140},{x:130,y:300},{x:370,y:300}];t=t.filter((t=>t.x!==this.coin.x));let e=Phaser.Math.RND.pick(t);this.coin.setPosition(e.x,e.y)}addEnemy(){let t=this.enemies.create(250,-10,"enemy");t.body.gravity.y=500,t.body.velocity.x=Phaser.Math.RND.pick([-100,100]),t.body.bounce.x=1,this.time.addEvent({delay:1e4,callback:()=>t.destroy()})}playerDie(){this.player.destroy(),this.deadSound.play(),this.emitter.setPosition(this.player.x,this.player.y),this.emitter.explode(),this.cameras.main.shake(300,.02),this.time.addEvent({delay:1e3,callback:()=>this.scene.start("menu",{score:this.score})})}addMobileInputs(){this.moveLeft=!1,this.moveRight=!1;let t=this.add.sprite(400,290,"jumpButton");t.setInteractive(),t.alpha=.5,t.on("pointerdown",this.jumpPlayer,this);let e=this.add.sprite(100,290,"leftButton");e.setInteractive(),e.on("pointerover",(()=>this.moveLeft=!0),this),e.on("pointerout",(()=>this.moveLeft=!1),this),e.alpha=.5;let s=this.add.sprite(180,290,"rightButton");s.setInteractive(),s.on("pointerover",(()=>this.moveRight=!0),this),s.on("pointerout",(()=>this.moveRight=!1),this),s.alpha=.5}jumpPlayer(){this.player.body.onFloor()&&(this.player.body.velocity.y=-320,this.jumpSound.play())}orientationChange(){this.scale.orientation.toString()===Phaser.Scale.PORTRAIT?(this.rotateLabel.setText(" rotate your device in landscape"),this.scene.pause()):this.scale.orientation.toString()===Phaser.Scale.LANDSCAPE&&(this.rotateLabel.setText(""),this.scene.resume())}}let i=new Phaser.Game({width:500,height:340,backgroundColor:"#3498db",physics:{default:"arcade"},parent:"game",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,min:{width:250,height:170},max:{width:1e3,height:680}}});i.scene.add("load",t),i.scene.add("menu",e),i.scene.add("play",s),i.scene.start("load")}();
